import numpy as np
import matplotlib.pyplot as plt

gamma = 1.0
omega = 1

def y_exact(t):
    t = np.asarray(t, dtype=float) 

    Omega = 0.5 * np.sqrt(4 - gamma**2)
    Delta = (1 - omega**2)**2 + gamma**2 * omega**2

    homo = np.exp(-gamma * t / 2) * (
        (gamma * omega / Delta) * np.cos(Omega * t)
        + (omega * (omega**2 + gamma**2 / 2 - 1) / (Delta * Omega))
        * np.sin(Omega * t)
    )

    ps = (
        (1 - omega**2) * np.sin(omega * t)
        - gamma * omega * np.cos(omega * t)
    ) / Delta

    return homo + ps  

x_euler = np.array([0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2, 5.6, 6.0, 6.4, 6.8, 7.2, 7.6, 8.0, 8.4, 8.8, 9.2, 9.6, 10.0, 10.4, 10.8, 11.2, 11.6, 12.0, 12.4, 12.8, 13.2, 13.6, 14.0, 14.4, 14.8, 15.2, 15.6, 16.0, 16.4, 16.8, 17.2, 17.6, 18.0, 18.4, 18.8, 19.2, 19.6, 20.0, 20.4, 20.8, 21.2, 21.6, 22.0, 22.4, 22.8, 23.2, 23.6, 24.0, 24.4, 24.8, 25.2, 25.6, 26.0, 26.4, 26.8, 27.2, 27.6, 28.0, 28.4, 28.8, 29.2, 29.6, 30.0, 30.4, 30.8, 31.2, 31.6, 32.0, 32.4, 32.8, 33.2, 33.6, 34.0, 34.4, 34.8, 35.2, 35.6, 36.0, 36.4, 36.8, 37.2, 37.6, 38.0, 38.4, 38.8, 39.2, 39.6, 40.0])

y_euler = np.array([0.0, 0.009536127878162938, 0.06622837093663349, 0.18888805428486474, 0.3668152874336246, 0.5666542578575519, 0.7429358334482761, 0.8499198922473303, 0.852462675899841, 0.7340543539956574, 0.5008151583012012, 0.18100071645162558, -0.17966413549277888, -0.5258365897953208, -0.8021295754697279, -0.962720378649513, -0.9793555023342533, -0.8464185987529906, -0.5822360809027141, -0.22642186104162682, 0.16629096165888752, 0.5347186275040509, 0.8209860067756998, 0.9797990540895805, 0.9857371997524399, 0.8373939110715519, 0.5576998581150108, 0.1903731085950146, -0.206942274745204, -0.5717614726298751, -0.8466273259720489, -0.9881972386643646, -0.9741078683277586, -0.8065289451953729, -0.511841712222303, -0.13649072870786438, 0.2603368682742107, 0.6160487582813163, 0.8745266140937394, 0.9949863396487101, 0.9584194397579422, 0.7705975689483233, 0.4611650964961781, 0.07896237470952416, -0.31568228159998274, -0.6604751223295922, -0.9009905899916489, -0.9992634247679153, -0.9397825785210349, -0.7319404520460217, -0.40855060969807233, -0.02066785694312767, 0.37047162009372914, 0.7031176370897706, 0.9247546744813311, 1.000392721445073, 0.9180913418563194, 0.6908448073241122, 0.3545306471150969, -0.03775453338040474, -0.42407773829442025, -0.743447345517448, -0.945442265532786, -0.9981722669023091, -0.8933127082876559, -0.6474188008823555, -0.2993119038801716, 0.09604950529622991, 0.4762465514497748, 0.7812545130845185, 0.9629193906235592, 0.9925603513142037, 0.8654977927224377, 0.6017921432339783, 0.24307675880111107, -0.1540150687789319, -0.5267912619625186, -0.8163986556696305, -0.9771146153047403, -0.9835656328620598, -0.8347332438002163, -0.5541148186319161, -0.18601384379177988, 0.21145462519814023, 0.575539053225044, 0.8487585129807597, 0.9879776591143861, 0.9712168503662358, 0.801122251215221, 0.5045480603388779, 0.12831682285024032, -0.26817282020859085, -0.6223238713114931, -0.8782236659888227, -0.9954712531060799, -0.9555558166511459, -0.7647791264955913, -0.4532606274264283, -0.0701822410223244, 0.3239763783951322, 0.6669862513801652] )

x_fine = np.linspace(x_euler.min(), x_euler.max(), 4000)
y_fine = y_exact(x_fine)

h = x_euler[1] - x_euler[0]

plt.figure(figsize=(8, 5))
plt.plot(x_fine, y_fine, label="Exact solution", linewidth=2)
plt.plot(x_euler, y_euler, 'o-', label=f"Numerical method (h={h:g})", alpha=0.7)

plt.xlabel("t")
plt.ylabel("y(t)")
plt.legend(loc="upper right")

plt.grid(True)
plt.show()
